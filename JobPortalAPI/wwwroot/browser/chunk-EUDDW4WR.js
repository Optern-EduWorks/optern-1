import{b as P,c as w,d as k,e as I,f as O,g as E,n as T,o as L}from"./chunk-QUUDTLWW.js";import{b as M,d as y}from"./chunk-XUDBPULL.js";import{a as S}from"./chunk-YAEOSTW2.js";import{k as x,r as C}from"./chunk-ZCJ7ANON.js";import{Aa as c,Ga as b,La as v,Wa as m,Xa as i,Ya as o,eb as g,gb as p,lb as r,mb as u,pb as f,qb as h,rb as _,ua as l}from"./chunk-3PLKYEVT.js";function N(s,a){if(s&1&&(i(0,"div",17),r(1),o()),s&2){let e=p();l(),u(e.error)}}function z(s,a){if(s&1&&(i(0,"div",18),r(1),o()),s&2){let e=p();l(),u(e.successMessage)}}var D=class s{constructor(a,e,t){this.router=a;this.auth=e;this.route=t;let d=this.route.snapshot.queryParamMap.get("registered"),n=this.route.snapshot.queryParamMap.get("email");d&&(this.successMessage="Account created successfully. Please sign in.",n&&(this.model.email=n))}model={email:"",password:""};error=null;successMessage=null;onSubmit(a){a.preventDefault(),this.error=null,console.log("Login form submitted with:",this.model.email,this.model.password),this.auth.logout();try{localStorage.removeItem("optern_user"),console.log("Cleared localStorage before login")}catch(e){console.error("Failed to clear localStorage:",e)}this.auth.login(this.model.email,this.model.password).subscribe({next:e=>{console.log("Login successful, full response:",e),setTimeout(()=>{let t=this.auth.getCurrentUser();console.log("Current user after login (with delay):",t),t&&t.userId>0?(console.log("Login fully successful, navigating to dashboard"),this.router.navigate(["/candidate/dashboard"])):(console.error("Login response received but user not set properly"),this.error="Login failed - please check credentials and try again")},100)},error:e=>{if(e?.status===0){this.error="Unable to contact server. Please check if the server is running and try again.";return}let t=e?.error;t?typeof t=="string"?this.error=this.stripHtml(t):typeof t.message=="string"?this.error=this.stripHtml(t.message):this.error="Login failed. Please check your credentials and try again.":e?.message?this.error=this.stripHtml(e.message):this.error="Login failed. Please check your credentials and try again."}})}loginWithCredentials(a,e){this.model.email=a,this.model.password=e,this.onSubmit(new Event("submit"))}navigateToSignUp(){this.router.navigate(["/candidate/sign-up"])}navigateToHome(){this.router.navigate(["/"])}stripHtml(a){let e=document.createElement("DIV");return e.innerHTML=a,e.textContent||e.innerText||a}static \u0275fac=function(e){return new(e||s)(c(y),c(S),c(M))};static \u0275cmp=b({type:s,selectors:[["app-candidate-sign-in"]],decls:29,vars:4,consts:[[1,"login-container"],[1,"login-card"],[1,"logo-container"],[1,"logo"],[1,"portal-text"],["onsubmit","return false;","novalidate","",3,"ngSubmit"],[1,"form-group"],["for","email"],["type","email","id","email","name","email","placeholder","Enter your email","autocomplete","username","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","placeholder","Enter your password","autocomplete","current-password","required","",3,"ngModelChange","ngModel"],["type","submit",1,"login-button"],["class","error","style","margin-top:12px",4,"ngIf"],["class","success","style","margin-top:12px",4,"ngIf"],[1,"signup-link"],["href","#",3,"click"],[1,"back-to-home"],[1,"error",2,"margin-top","12px"],[1,"success",2,"margin-top","12px"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),r(4,"O"),o()(),i(5,"h2"),r(6,"Welcome back"),o(),i(7,"p",4),r(8,"Candidate Portal"),o(),i(9,"form",5),g("ngSubmit",function(n){return t.onSubmit(n)}),i(10,"div",6)(11,"label",7),r(12,"Email or Username"),o(),i(13,"input",8),_("ngModelChange",function(n){return h(t.model.email,n)||(t.model.email=n),n}),o()(),i(14,"div",6)(15,"label",9),r(16,"Password"),o(),i(17,"input",10),_("ngModelChange",function(n){return h(t.model.password,n)||(t.model.password=n),n}),o()(),i(18,"button",11),r(19,"Sign In"),o(),v(20,N,2,1,"div",12)(21,z,2,1,"div",13),o(),i(22,"div",14),r(23," Don't have an account? "),i(24,"a",15),g("click",function(n){return t.navigateToSignUp(),n.preventDefault()}),r(25,"Sign up"),o()(),i(26,"div",16)(27,"a",15),g("click",function(n){return t.navigateToHome(),n.preventDefault()}),r(28,"\u2190 Back to home"),o()()()()),e&2&&(l(13),f("ngModel",t.model.email),l(4),f("ngModel",t.model.password),l(3),m("ngIf",t.error),l(),m("ngIf",t.successMessage))},dependencies:[L,E,P,w,k,T,O,I,C,x],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f0f2f5}.login-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:10px;padding:30px;box-shadow:0 0 20px #0000001a;width:350px;text-align:center}.logo-container[_ngcontent-%COMP%]{width:60px;height:60px;background-color:#3f51b5;color:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;margin:0 auto 20px}.logo[_ngcontent-%COMP%]{font-size:24px;font-weight:700}h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:5px;color:#333}.portal-text[_ngcontent-%COMP%]{font-size:14px;color:#777;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:left}label[_ngcontent-%COMP%]{display:block;font-size:14px;color:#555;margin-bottom:5px}input[type=email][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ddd;border-radius:5px;font-size:16px;color:#333;box-sizing:border-box}input[type=email][_ngcontent-%COMP%]:focus, input[type=password][_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5}.login-button[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;border:none;border-radius:5px;padding:12px 20px;font-size:16px;cursor:pointer;width:100%;transition:background-color .3s ease}.login-button[_ngcontent-%COMP%]:hover{background-color:#303f9f}.signup-link[_ngcontent-%COMP%], .back-to-home[_ngcontent-%COMP%]{margin-top:15px;font-size:14px;color:#555}.signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .back-to-home[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3f51b5;text-decoration:none}.signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .back-to-home[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};export{D as a};
