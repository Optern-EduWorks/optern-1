import{b as u}from"./chunk-RG4DZT4R.js";import{O as l,S as p,a as s,b as o,n as c,q as a,y as r}from"./chunk-3PLKYEVT.js";var h=class n{constructor(e){this.http=e}apiUrl="api/grievances";getAllGrievances(){return this.http.get(this.apiUrl).pipe(r(this.handleError))}getGrievanceById(e){return this.http.get(`${this.apiUrl}/${e}`).pipe(r(this.handleError))}createGrievance(e){console.log("Creating grievance:",e);let t=o(s({},e),{status:e.status||"Submitted",createdDate:e.createdDate||new Date().toISOString()});return this.http.post(this.apiUrl,t,{timeout:3e4}).pipe(a(i=>(console.log("Grievance created successfully:",i),i)),r(this.handleError))}uploadFile(e){let t=new FormData;return t.append("file",e),this.http.post(`${this.apiUrl}/upload`,t).pipe(r(this.handleError))}createGrievanceWithAttachment(e){return console.log("Creating grievance with attachment..."),this.http.post(`${this.apiUrl}/create-with-attachment`,e,{timeout:6e4,reportProgress:!0}).pipe(a(t=>(console.log("Grievance with attachment created successfully:",t),t)),r(this.handleError))}updateGrievance(e,t){return this.http.put(`${this.apiUrl}/${e}`,t).pipe(r(this.handleError))}deleteGrievance(e){return this.http.delete(`${this.apiUrl}/${e}`).pipe(r(this.handleError))}getGrievancesByUser(e){return console.log("Fetching grievances for user:",e),this.http.get(this.apiUrl).pipe(a(t=>{console.log("All grievances:",t);let i=t.filter(v=>v.submittedBy===e);return console.log("Filtered grievances for user:",i),i}),r(this.handleError))}handleError(e){console.error("Grievance API Error:",e);let t="An error occurred while processing your request.";return e.error instanceof ErrorEvent?t=`Error: ${e.error.message}`:e.error&&e.error.message?t=e.error.message:e.status===0?t="Unable to connect to the server. Please check your connection.":e.status===404?t="The requested resource was not found.":e.status===500&&(t="Internal server error. Please try again later."),c(()=>new Error(t))}static \u0275fac=function(t){return new(t||n)(p(u))};static \u0275prov=l({token:n,factory:n.\u0275fac,providedIn:"root"})};export{h as a};
